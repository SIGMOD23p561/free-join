# name: test/sql/tpcds/tpcds_topn.test_slow
# description: Test top-n queries on TPC-DS
# group: [tpcds]

require tpcds

statement ok
PRAGMA enable_verification

statement ok
CALL dsdgen(sf=1);

query IIIIIIIIIIIIIIIIII
SELECT * FROM customer ORDER BY c_customer_sk DESC, c_customer_id DESC LIMIT 5;
----
100000	AAAAAAAAAKGIBAAA	441077	4582	8487	2449763	2449733	Mrs.	Erica	Parrott	N	16	7	1939	BELGIUM	(empty)	Erica.Parrott@9pnE.com	2452621
99999	AAAAAAAAPJGIBAAA	1641963	292	15421	2452000	2451970	Mr.	Rex	Reyes	Y	9	7	1981	GREECE	(empty)	Rex.Reyes@saLGsYab.org	2452297
99998	AAAAAAAAOJGIBAAA	1030893	4338	46583	2452285	2452255	Dr.	Helen	Bateman	N	8	11	1979	UNITED KINGDOM	(empty)	Helen.Bateman@bVJ4ND7frLIIJZX.org	2452541
99997	AAAAAAAANJGIBAAA	1822151	6135	2919	2450290	2450260	Dr.	Jennifer	Bolton	Y	9	4	1954	BRUNEI DARUSSALAM	(empty)	Jennifer.Bolton@ecidoI.com	2452497
99996	AAAAAAAAMJGIBAAA	1106140	769	29398	2451524	2451494	Dr.	Larry	Kerr	Y	20	9	1959	LITHUANIA	(empty)	Larry.Kerr@V6KToJQKDF4a.org	2452300

query IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
SELECT * FROM web_sales ORDER BY ws_sold_date_sk DESC, ws_sold_time_sk, ws_ship_date_sk DESC LIMIT 5;
----
2452642	150	2452754	5448	54282	327982	6835	10135	64413	768001	731	18708	49	21	17	3	209	21442	76	0.73	1.99	1.77	16.61	134.39	55.72	151.00	9.41	0.00	69.46	134.39	143.80	203.85	213.25	78.67
2452642	150	2452749	12234	54282	327982	6835	10135	64413	768001	731	18708	49	30	18	3	151	21442	54	0.34	0.43	0.01	22.71	0.46	18.54	23.17	0.02	0.00	6.49	0.46	0.48	6.94	6.97	-18.08
2452642	150	2452739	10692	54282	327982	6835	10135	64413	768001	731	18708	1	15	2	4	36	21442	97	0.23	0.69	0.15	53.03	14.09	22.76	67.12	0.00	0.00	24.83	14.09	14.09	38.93	38.93	-8.66
2452642	150	2452733	13719	54282	327982	6835	10135	64413	768001	731	18708	49	21	17	3	269	21442	17	0.55	0.77	0.35	7.20	5.89	9.29	13.10	0.18	0.00	1.70	5.89	6.07	7.59	7.77	-3.40
2452642	150	2452730	11448	54282	327982	6835	10135	64413	768001	731	18708	43	21	10	4	8	21442	79	0.78	1.21	0.02	94.03	1.91	61.50	95.94	0.15	0.00	35.49	1.91	2.06	37.41	37.56	-59.59

query IIIIIIIIIIIIIIIIIIIIIII
SELECT * FROM store_sales ORDER BY ss_wholesale_cost DESC, ss_list_price DESC, ss_sales_price DESC, ss_customer_sk ASC LIMIT 5;
----
2451497	41929	937	14692	941578	2064	17750	7	232	12771	80	1.00	2.00	2.00	159.65	159.65	79.82	159.65	0.00	159.65	0.00	0.00	-79.82
2451516	38371	14737	8772	1146909	3799	46336	2	183	41358	81	1.00	2.00	1.94	0.00	156.91	80.89	161.77	0.00	0.00	156.91	156.91	76.03
2452249	66171	15577	28354	899849	944	2486	1	143	61123	68	1.00	2.00	1.94	0.00	131.59	67.83	135.66	7.90	0.00	131.59	139.48	63.76
2452570	43508	9384	61386	1648140	1741	17295	1	26	3795	32	1.00	2.00	1.94	0.00	62.04	31.98	63.96	3.72	0.00	62.04	65.76	30.06
2451491	47992	8383	36146	153932	5318	27151	1	158	78215	19	1.00	2.00	1.90	19.85	36.08	18.99	37.98	0.49	19.85	16.24	16.73	-2.75
